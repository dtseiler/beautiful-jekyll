---
layout: post
title: 'HOWTO: Oracle Cross-Platform Migration with Minimal Downtime'
date: '2009-10-27T12:49:00.001-05:00'
author: Don Seiler
tags: 
modified_time: '2010-11-20T11:16:07.592-06:00'
blogger_id: tag:blogger.com,1999:blog-7032512792942232766.post-6171891122832905879
blogger_orig_url: http://www.seiler.us/2009/10/howto-oracle-cross-platform-migration.html
---

<em><span class="Apple-style-span" style="font-size: x-small;">Originally posted at <a href="http://www.pythian.com/news/3653/howto-oracle-cross-platform-migration-with-minimal-downtime">The Pythian Group blog</a>.</span></em><br /><br />I recently performed a migration from Oracle 10gR2 on Solaris to the same version on Linux, immediately followed by an upgrade to 11g.  Both platforms were x86-64.  Migrating to Linux also included migrating to ASM, whereas we had been using ZFS to hold the datafiles on Solaris.  Restoring files into ASM meant we would have to use RMAN (which we would probably choose to use anyway).<br /><br />As with many databases, the client wanted minimal downtime.  It was obvious to us that the most time-consuming operation would be the restore and recovery into the new instance.  We were basically doing a restore and recovery from production backups and archived redo logs.  It quickly dawned on me that we could start this operation well before the scheduled cutover time and downtime window, chopping at least six hours from the downtime window.  The client would only need to keep the new instance in mount mode after the initial restore/recovery finished, periodically re-catalog the source instance's FRA (which was mounted via NFS), and then re-run the <code>recover database</code> command in RMAN.  Once the time comes to cutover, simply <code>archivelog current</code> the original instance and <code>shutdown immediate</code>.  Then open the new instance with the <code>RESETLOGS</code> option, and voila!  Migration complete!<br /><br />I'll try to recreate a simple example here.  <br /><a name='more'></a><br />On the new instance, assume that you have ASM set up and configured with two disk groups, <code>DATA</code> and <code>REDO</code>.  Let's also assume that you have the FRA directory (or the directory where you hold backups and archivelogs) mounted from the Solaris host to the Linux host under <code>/solfra/prod/</code>.  Here's the command we used:<br /><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">mount -o hard,bg,tcp,nfsvers=3,suid,rsize=32768,wsize=32768,nointr,noac,ro solhost:/fra /solfra/</span></span><br /><br />We then need to get a pfile and edit it for <em>ASM-ification</em>.  You can either restore the spfile from backup or just export a pfile from the current running production instance.  To do the former, you'd need to go into RMAN and run an operation similar to this (best to ensure that the <code>ORACLE_HOME</code>, <code>ORACLE_SID</code>, and other Oracle-related environment variables are set properly):<br /><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN&gt; startup force</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><br /></span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">startup failed: ORA-01078: failure in processing system parameters</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">LRM-00109: could not open parameter file '/home/oracle/app/oracle/product/10.2.0/db_1/dbs/initprod.ora'</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><br /></span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">starting Oracle instance without parameter file for retrival of spfile</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">Oracle instance started</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN-00571: ===========================================================</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN-00571: ===========================================================</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN-03002: failure of startup command at 06/29/2009 13:34:50</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">ORA-00205: error in identifying control file, check alert log for more info</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN&gt;</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN&gt; restore spfile to pfile 'initprod.ora' from autobackup recovery area = '/solfra/' db_unique_name = 'PROD';</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><br /></span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">Starting restore at 29-JUN-09</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">using target database control file instead of recovery catalog</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">allocated channel: ORA_DISK_1</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">channel ORA_DISK_1: sid=36 devtype=DISK</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><br /></span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">recovery area destination: /solfra/</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">database name (or database unique name) used for search: PROD</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">channel ORA_DISK_1: autobackup found in the recovery area</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">channel ORA_DISK_1: autobackup found: /solfra/PROD/autobackup/2009_06_29/o1_mf_s_690813149_54kypcxz_.bkp</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">channel ORA_DISK_1: SPFILE restore from autobackup complete</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">Finished restore at 29-JUN-09</span></span><br /><br />From here you can go into sqlplus and <code>CREATE PFILE FROM SPFILE;</code>.<br /><br />Now we have our text pfile in <code>$ORACLE_HOME/dbs/initprod.ora</code>, and we want to make these changes specific to the transition to ASM:<br /><br /><pre>*.control_files='+DATA','+REDO'<br />*.db_create_file_dest='+DATA'<br />*.db_create_online_log_dest_1='+REDO'<br />*.db_recovery_file_dest='/path/to/fra'<br />*.db_recovery_file_dest_size='2000G'<br /></pre><br />Obviously, the last two parameters about location and size of the FRA should be tailored to your setup.<br /><br />We then create a new SPFILE with <code>CREATE SPFILE FROM PFILE;</code>.<br /><br />Now we're ready to restore the controlfile(s) from backup:<br /><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN&gt; startup force;</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><br /></span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">Oracle instance started</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN-00571: ===========================================================</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN-00569: =============== ERROR MESSAGE STACK FOLLOWS ===============</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN-00571: ===========================================================</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN-03002: failure of startup command at 08/13/2009 20:20:56</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">ORA-00205: error in identifying control file, check alert log for more info</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><br /></span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">RMAN&gt; restore controlfile from autobackup recovery area = '/solfra/' db_unique_name = 'PROD';</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><br /></span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">Starting restore at 13-AUG-09</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">using target database control file instead of recovery catalog</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">allocated channel: ORA_DISK_1</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">channel ORA_DISK_1: sid=650 devtype=DISK</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><br /></span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">recovery area destination: /solfra/</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">database name (or database unique name) used for search: PROD</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">channel ORA_DISK_1: autobackup found in the recovery area</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">channel ORA_DISK_1: autobackup found: /solfra/PROD/autobackup/2009_08_13/o1_mf_s_694801261_5890xyoj_.bkp</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">channel ORA_DISK_1: control file restore from autobackup complete</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">output filename=+DATA/prod/controlfile/current.256.694815695</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">output filename=+REDO/prod/controlfile/current.256.694815697</span></span><br /><span class="Apple-style-span" style="font-size: x-small;"><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;">Finished restore at 13-AUG-00</span></span><br /><br />Note that if you restored the spfile from backup, you don't need to specify the recovery area in the <code>restore controlfile from autobackup</code> command.  In this case, because I chose to create a pfile from the source instance, I needed to supply the recovery area location.  Note that this is the recovery area that holds the source backups, not the recovery area that your new instance will use once it is opened.<br /><br />With the control files restored, we can mount the new instance:<br /><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">RMAN&gt; alter database mount;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">database mounted</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">released channel: ORA_DISK_1</span></span><br /><br />The next step is to catalog the backup files and archivelogs from the remote FRA.<br /><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">RMAN&gt; CATALOG START WITH '/solfra/PROD' NOPROMPT;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">Starting implicit crosscheck backup at 13-AUG-09</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">allocated channel: ORA_DISK_1</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">channel ORA_DISK_1: sid=646 devtype=DISK</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">allocated channel: ORA_DISK_2</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">channel ORA_DISK_2: sid=650 devtype=DISK</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">Crosschecked 565 objects</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">Finished implicit crosscheck backup at 13-AUG-09</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">Starting implicit crosscheck copy at 13-AUG-09</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">using channel ORA_DISK_1</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">using channel ORA_DISK_2</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">Finished implicit crosscheck copy at 13-AUG-09</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">searching for all files in the recovery area</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">cataloging files...</span></span><br /><br />This will continue listing all the files in the catalog, and some files that were not cataloged (e.g. online redo logs, non-RMAN files, etc.).<br /><br />Now we're ready to begin our RESTORE phase.  You'll need an rman command file that looks something like this:<br /><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">run {</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">set newname for datafile X to new;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"># ... (repeat for other datafiles)</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">set newname for tempfile Y to new;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"># ... (repeat for other tempfiles)</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">restore database;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">switch datafile all;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">switch tempfile all;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">}</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">recover database;</span></span><br /><br />Note that X and Y are the file# of the individual datafile and tempfile, respectively.  You will probably want to generate this file if you have a large number of datafiles.<br /><br />It is important that you read MetaLink Doc 415884.1, if you are performing a migration to a different platform with the same endian.  Oracle suggests that you should perform a CONVERT DATABASE, but later admits that you only need to perform a CONVERT on tablespaces containing UNDO segments:<br /><blockquote>The convert database command is a no operation command for all files that do not contain undo but they are scanned regardless during the conversion. Using the convert tablespace/datafile for those containing undo will suffice and all other source files not containing undo can be moved to the target (same endian) platform without the Recovery Manager conversion. This will greatly reduce the time required to move and database with thousands of files from source to target platform also decreasing the amount of time the database is unavailable.</blockquote>We had an internal debate over whether or not it is truly necessary even to do this.  However, I would advise you to read this document and discuss it with Oracle Support Services.  They would most likely try to convince you to do it or threaten to not support your database.<br /><br />Once the script finishes with the <code>recover database</code> portion, this query should indicate that datafile headers and controlfiles are in sync:<br /><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">SQL&gt; alter session set nls_date_format='YYYY/MON/DD hh24:mi:ss';</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">Session altered.</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">SQL&gt; select checkpoint_time,fuzzy,count(*),status</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">from ( select checkpoint_time,fuzzy,status</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">from v$datafile_header</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">union all</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">select controlfile_time,'CTL',null from v$database)</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">group by checkpoint_time,fuzzy,status;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">CHECKPOINT_TIME      FUZ   COUNT(*) STATUS</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">-------------------- --- ---------- -------</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">2009/AUG/14 02:22:11 CTL   1</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">2009/AUG/14 02:22:11 YES       1266 ONLINE</span></span><br /><br />The database is still in mount mode.  If we were ready to cut over now, we could open the database with the <code>RESETLOGS</code> option.  However, we are still a few hours or a day away from the cutover.  What we want to do is apply more logs from the current production instance as they get archived. To minimize the babysitting, we decided to run this in a script once every few hours:<br /><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">CATALOG START WITH '/solfra/PROD' NOPROMPT;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">RECOVER DATABASE;</span></span><br /><br />As you can guess, this re-catalogs the NFS-mounted FRA, ignoring files that were already cataloged.  So now the controlfile knows about the new archivelogs.  The <code>RECOVER DATABASE</code> command then beautifully applies logs from where it left off until it runs out of logs again.  We re-run this periodically to keep our new instance as close to current as possible until it's time to cut over.<br /><br />When the cutover time comes, we run this on the current production instance:<br /><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">SQL&gt; alter system archive log current;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">System altered.</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">SQL&gt; shutdown immediate;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">Database closed.</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">Database dismounted.</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">ORACLE instance shut down.</span></span><br /><br />Then, on the new instance, we do one last catalog and recover.  This should bring us completely up to date with the original prod instance.  Now we just need to open with resetlogs:<br /><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">SQL&gt; alter database open resetlogs;</span></span><br /><span class="Apple-style-span" style="font-family: 'Courier New', Courier, monospace;"><span class="Apple-style-span" style="font-size: x-small;">Database altered.</span></span><br /><br />In my case, I manually renamed the online and standby redo logs to <code>+REDO</code> (they still had the old filesystem names in v$logfile), but I believe that <code>OPEN RESETLOGS</code> does this automatically anyway.<br /><br />And so, here we are in Linux on on the same version (10.2.0.2) as Solaris with appropriate one-off patches, using ASM.  At this point, I was just under 30 minutes into my downtime window since the original prod instance was shutdown.  I don't think that's too bad for moving a 1.3T database!<br /><br />After this, I immediately went into upgrading to 11gR1 (11.1.0.7) and then building a new standby instance, but that is outside the scope of the initial migration that I wanted to share with you today.  Cheers!