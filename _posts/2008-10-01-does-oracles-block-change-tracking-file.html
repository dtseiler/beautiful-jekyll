---
layout: post
title: Does Oracle’s Block Change Tracking File Shrink?
date: '2008-10-01T10:10:00.000-05:00'
author: Don Seiler
tags: 
modified_time: '2010-11-20T11:44:18.352-06:00'
blogger_id: tag:blogger.com,1999:blog-7032512792942232766.post-4400287131821877868
blogger_orig_url: http://www.seiler.us/2008/10/does-oracles-block-change-tracking-file.html
---

<em><span class="Apple-style-span" style="font-size: x-small;">Reposted from <a href="http://www.pythian.com/blogs/1163/does-oracle-block-change-tracking-file-shrink">The Pythian Group blog</a>.</span></em><br /><br />Just a quick post to get myself back into blogging mode.  Recently in IRC (<a href="irc://irc.freenode.net/#oracle">#oracle on freenode</a>, to be precise), a fresh face asked if the <a href="http://www.oracle.com/technology/oramag/oracle/04-nov/o64rman.html">Block Change Tracking file</a> ever shrinks.  She had been worrying about the file in her instance continuing to grow.  A number of us speculated (non-<a href="http://www.battleagainstanyguess.com/">BAAG</a>!) that perhaps taking an RMAN backup would somehow purge the file of what it was keeping track of, and then the magical Oracle fairies would promptly resize it for us. Needless to say, I was hesitant to take this theory forward with <a href="http://www.pythian.com/blogs/483/block-change-tracking-internals-x-tables-research-xkrc-snappack">Alex Gorbachev</a> aware of my home address.<br /><br />After setting up Oracle 10.2.0.1 on a nice <a href="http://www.virtualbox.org/">VirtualBox</a> image&nbsp;(more on that in another post) running <a href="http://centos.org/">CentOS</a> 5, I began to do some reading.  For some reason, actually reading <a href="http://tahiti.oracle.com/">the official tahiti docs</a> was last on my list.  A search of the 10gR2 docs quickly yielded <a href="http://download.oracle.com/docs/cd/B19306_01/backup.102/b14192/bkup004.htm#sthref424">this (from <em>RMAN Incremental Backups</em>)</a>:<br /><blockquote><strong>4.4.4.4 Estimating Size of the Change Tracking File on Disk<br /></strong><br /><br />The size of the change tracking file is proportional to the size of the database and the number of enabled threads of redo. The size is not related to the frequency of updates to the database. Typically, the space required for block change tracking is approximately 1/30,000 the size of the data blocks to be tracked. Note, however, the following two factors that may cause the file to be larger than this estimate suggests:<br /><ul><li>To avoid overhead of allocating space as your database grows, the change tracking file size starts at 10MB, and new space is allocated in 10MB incremenents [<em>sic</em>]. Thus, for any database up to approximately 300GB the file size is no smaller than 10MB, for up to approximately 600GB the file size is no smaller than 20MB, and so on.</li><li>For each datafile, a minimum of 320K of space is allocated in the change tracking file, regardless of the size of the file. Thus, if you have a large number of relatively small datafiles, the change tracking file is larger than for databases with a smaller number of larger datafiles containing the same data.</li></ul></blockquote>So (if the docs are to be trusted), it would seem that whether or not a backup is taken has no effect on the size of the file, or at least wouldn’t cause it to be shrunk. The size is tied to the amount of data in the database itself, not necessarily the changes in the database waiting to be included in the next incremental RMAN backup.<br /><br />The documentation does suggest, however, that file size might be affected if (for example) a tablespace and its datafiles were dropped from the database. I’ll save this test for another day!