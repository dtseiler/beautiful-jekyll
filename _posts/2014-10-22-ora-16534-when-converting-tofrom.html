---
layout: post
title: ORA-16534 When Converting to/from Snapshot Standby with DataGuard Broker
date: '2014-10-22T23:00:00.001-05:00'
author: Don Seiler
tags:
- 11gR2
- data guard
- oracle
modified_time: '2014-10-22T23:00:35.061-05:00'
blogger_id: tag:blogger.com,1999:blog-7032512792942232766.post-7717411070315766153
blogger_orig_url: http://www.seiler.us/2014/10/ora-16534-when-converting-tofrom.html
---

We here at Seilerwerks Industries (not really) have been using snapshot standby databases to refresh an array of unit test databases from a common primary. During the business day, these would be converted to snapshot standby databases for testing, then overnight they are converted back to physical standby and recovered up to the master again.<br /><br />However we ran into one problem the other week. I noticed that the test3 database was still in physical standby mode well into the business day. Trying to manually convert returned this error:<br /><br /><span style="font-family: Courier New, Courier, monospace;">DGMGRL&gt; convert database test3 to snapshot standby</span><br /><span style="font-family: Courier New, Courier, monospace;">Converting database "test3" to a Snapshot Standby database, please wait...</span><br /><span style="font-family: Courier New, Courier, monospace;">Error:</span><br /><span style="font-family: Courier New, Courier, monospace;">ORA-16534: switchover, failover or convert operation in progress</span><br /><span style="font-family: Courier New, Courier, monospace;">ORA-06512: at "SYS.DBMS_DRS", line 157</span><br /><span style="font-family: Courier New, Courier, monospace;">ORA-06512: at line 1</span><br /><br />A quick search of MOS yielded bug 13716797&nbsp;(ORA-16534 from the broker when setting apply-off),&nbsp;which simply suggested restarting the problem database when encountering that error. However doing so did not get me any further. That's when the I checked the Data Guard Broker configuration:<br /><br /><span style="font-family: Courier New, Courier, monospace;">DGMGRL&gt; show configuration;</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">Configuration - testdb</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">&nbsp; Protection Mode: MaxPerformance</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; Databases:</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; test1 - Primary database</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; test5 - Physical standby database</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; test6 - Snapshot standby database</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; test3 - Physical standby database</span><br /><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; test4 - Snapshot standby database</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">Fast-Start Failover: DISABLED</span><br /><span style="font-family: Courier New, Courier, monospace;"><br /></span><span style="font-family: Courier New, Courier, monospace;">Configuration Status:</span><br /><span style="font-family: Courier New, Courier, monospace;">ORA-16610: command "CONVERT DATABASE test6" in progress</span><br /><span style="font-family: Courier New, Courier, monospace;">DGM-17017: unable to determine configuration status</span><br /><div><br /></div><div><div>Looks like I have two databases stuck in physical standby mode, test3 and also test6. And the configuration is specifically complaining about test6. So I restarted that database and, sure enough, I was then able to convert both back to snapshots:<br /><br /></div><div><span style="font-family: Courier New, Courier, monospace;">DGMGRL&gt; show configuration;</span></div><div><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace;">Configuration - testdb</span></div><div><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; Protection Mode: MaxPerformance</span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; Databases:</span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; test1 - Primary database</span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; test5 - Snapshot standby database</span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; test6 - Snapshot standby database</span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; test3 - Snapshot standby database</span></div><div><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp; test4 - Snapshot standby database</span></div><div><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace;">Fast-Start Failover: DISABLED</span></div><div><span style="font-family: Courier New, Courier, monospace;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace;">Configuration Status:</span></div><div><span style="font-family: Courier New, Courier, monospace;">SUCCESS</span><br /><br />It was very interesting to me to see one member of the Data Guard configuration prevent me from performing an operation on a different member. Hopefully this helps one of you in the future.</div></div><div><br /></div>